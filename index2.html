<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>test</title>
</head>
<body>
<script type="text/javascript">
  // 杨辉三角题目
  // 输入列、行C(4, 6)
  // 不存在返回0
  function C(col, row) {
    // 转换数据
    col -= 1
    row -= 1
    // 对称性质
    let revert = row - col
    col = col > revert ? revert : col
    // 不存在的情况(且排除了分母为0情况)
    if (row < 0 || col < 0 || col > row) {
      throw new Error('请求的行列不存在!')
    }
    // 边和顶部返回值
    if (col === 0 || row === 0) {
      return 1
    }
    console.log(row, row - col + 1, col)
    // 返回结果
    return divide(fa(row, row - col + 1), fa(col, 1))
  }

  // 计算阶乘
  function factorial(n, begin) {
    let result = 1
    while (begin >= 1) {
      result *= (n / begin)
      begin--
      n--
    }
    return result
  }

  function fa(n, begin) {
    let result = n + ''
    while (--n >= begin) {
      result = multiplyOne(result, n)
    }
    return result
  }

  // 相加
  function add(big, small) {
    if (big.length < small.length) {
      [big, small] = [small, big]
    }
    small = small.padStart(big.length, '0')
    let parsedBig = big.split('').map(item => parseInt(item))
    let parsedSmall = small.split('').map(item => parseInt(item))

    let length = big.length
    let carry = 0
    for (let i = length - 1; i >= 0; i--) {
      let added = parsedBig[i] + parsedSmall[i] + carry
      parsedBig[i] = added % 10
      carry = Math.floor(added / 10)
    }
    if (carry) {
      parsedBig.unshift(carry)
    }
    return parsedBig.join('')
  }

  // 相减
  function reduce(big, small) {
    let symbol = ''
    if (big.length < small.length) {
      [big, small] = [small, big]
      symbol = '-'
    }

    if (big.length === small.length && compare(small, big)) {
      [big, small] = [small, big]
      symbol = '-'
    }

    small = small.padStart(big.length, '0')
    let parsedBig = big.split('').map(item => parseInt(item))
    let parsedSmall = small.split('').map(item => parseInt(item))

    let length = big.length
    let carry = 0
    for (let i = length - 1; i >= 0; i--) {
      parsedBig[i] -= carry
      carry = 0
      if (parsedSmall[i] > parsedBig[i]) {
        parsedBig[i] += 10
        carry = 1
      }
      parsedBig[i] = parsedBig[i] - parsedSmall[i]
    }
    let result = parsedBig.join('').replace(/^[0]*/, '')

    return symbol + (result ? result : '0')
  }

  // 比较，如果a>b 返回true
  function compare(a, b) {
    if (a.length > b.length) {
      return true
    }
    for (let i = 0; i < a.length; i++) {
      if (a[i] > b[i]) {
        return true
      } else if (a[i] < b[i]) {
        return false
      }
    }
    return false
  }

  // 大数(string)乘以整数
  function multiplyOne(num, n) {
    let parsedNumber = num.split('').map(item => parseInt(item))
    let carry = 0
    for (let i = parsedNumber.length - 1; i >= 0; i--) {
      let multiplied = parsedNumber[i] * n + carry
      parsedNumber[i] = multiplied % 10
      carry = Math.floor(multiplied / 10)
    }
    if (carry) {
      parsedNumber.unshift(carry)
    }
    return parsedNumber.join('')
  }

  // 乘10
  function multiplyTen(num, n) {
    return num + new Array(n).fill('0').join('')
  }

  // 乘法

  function multiply(num, num2) {
    let parsedNumber = num.split('').map(item => parseInt(item))
    let length = parsedNumber.length - 1
    let result = '0'
    parsedNumber.forEach((item, index) => {
      result = add(result, multiplyTen(multiplyOne(num2, item), length - index))
    })
    return result
  }

  // 除

  function divide(dividend, divisor) {
    let result = '0'
    while (dividend !== '0' && dividend.indexOf('-') === -1) {
      if (dividend.length > divisor.length) {
        let newDivisor = ''
        let dividend0 = parseInt(dividend[0])
        let divisor0 = parseInt(divisor[0])
        let b = 1
        let zeroNum = 0
        if (dividend0 > divisor0) {
          newDivisor = divisor.padEnd(dividend.length, '0')
          zeroNum = dividend.length - divisor.length
        } else {
          b = Math.floor(dividend0 * 10 / (divisor0 + 1))
          newDivisor = multiplyOne(divisor.padEnd(dividend.length - 1, '0'), b)
          zeroNum = dividend.length - 1 - divisor.length
        }
        // console.log(zeroNum)
        dividend = reduce(dividend, newDivisor)
        let s = '1'
        while (zeroNum-- > 0) {
          s += '0'
        }
        result = add(result, multiplyOne(s, b))
      } else {
        dividend = reduce(dividend, divisor)
        result = add(result, '1')
      }
      // console.log(dividend)
    }
    // return dividend.indexOf('-') !== -1 ? result - 1 : result
    return result
  }

  // 输入(列， 行)
  C(1, 6)
</script>
</body>
</html>